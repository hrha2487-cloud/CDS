---
title: "Assignment 6: Under (blood) pressure"
author: Ruihan He
date: "10-2-2025`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(modelr))
# Load dataset
blood_pressure <- read_rds("blood_pressure.rds")
```

## Exercise 1 
```{r, fig.asp = 1, fig.width = 8, out.width = "100%"}
blood_pressure %>%
  pivot_longer(cols = Age:Pulse, names_to = "measurement", values_to = "value") %>%
  ggplot() +
    geom_point(mapping = aes(x = value, y = Systol)) +
    facet_wrap(~ measurement, scales = "free_x")
```

```{r, fig.asp = 1, fig.width = 8, out.width = "100%"}
blood_pressure %>%
  pivot_longer(cols = Age:Pulse, names_to = "measurement", values_to = "value") %>%
  ggplot() +
    geom_point(mapping = aes(x = value, y = Systol)) +
    geom_smooth(mapping = aes(x = value, y = Systol), method = "lm") +
    facet_wrap(~ measurement, scales = "free_x")
```


## Exercise 2
i.The Years variable has a positive correlation with Systol.
ii.The variable that shows a moderate to strong positive correlation with Systol is Weight.



## Exercise 3
```{r}
blood_pressure_updated <- blood_pressure %>%
  mutate(urban_frac_life = Years / Age)
```




## Exercise 4
```{r}
systol_urban_frac_model <- lm(Systol ~ urban_frac_life, data = blood_pressure_updated)
```




## Exercise 5
```{r}
systol_urban_frac_model %>%
  tidy()
```

```{r}
systol_urban_frac_model %>%
  glance()%>%
  select(r.squared)
```



## Exercise 6
```{r}
systol_urban_frac_df <- blood_pressure_updated %>%
  add_predictions(systol_urban_frac_model) %>%
  add_residuals(systol_urban_frac_model)
```
i.pred
ii.resid



## Exercise 7
```{r}
ggplot(systol_urban_frac_df) +
  geom_point(mapping = aes(x = urban_frac_life, y = Systol)) +
  geom_abline(slope = systol_urban_frac_model$coefficients[2], intercept = systol_urban_frac_model$coefficients[1])
```




## Exercise 8
The points above and below the line are roughly evenly spread across the range of urban_frac_life. The vertical variability does not noticeably increase or decrease as urban_frac_life changes. Therefore, the model meets the condition of constant variability.



## Exercise 9
i.The residuals are roughly symmetric and centered around zero.
ii.The histogram suggests that the residuals are nearly normal, because they form a roughly symmetric distribution around zero. This indicates that the prediction errors are evenly distributed, satisfying the second condition for a reliable linear regression model.



## Exercise 10
```{r}
systol_weight_model <- lm(Systol ~ Weight, data = blood_pressure_updated)
```
The R² value for the urban_frac_life model is 0.05, while the R² for the Weight model is 0.35.
This indicates that the Weight model predicts Systol better than the urban_frac_life model.



## Exercise 11
```{r}
systol_weight_df <- blood_pressure_updated %>%
  add_predictions(systol_weight_model) %>%
  add_residuals(systol_weight_model)
```

```{r}
ggplot(systol_weight_df, aes(x = Weight, y = Systol)) +
  geom_point() +
  geom_abline(
    slope = systol_weight_model$coefficients[2],
    intercept = systol_weight_model$coefficients[1],
  )
```

```{r}
ggplot(systol_weight_df, aes(x = resid)) +
  geom_histogram(binwidth = 2)
```
The scatter plot of Systol vs Weight with the regression line shows that the points are roughly aligned along a straight line, without obvious curvature. This indicates that the model meets the linearity assumption.
The histogram of residuals is roughly symmetric, suggesting that the residuals are nearly normal. Therefore, the model meets the assumption of nearly normal residuals.
The vertical spread of points around the regression line appears roughly uniform across all values of Weight. This indicates that the model meets the constant variability assumption.

## Exercise 12
The first model using urban_frac_life had an R² of 0.05, explaining only a small portion of the variability in Systol. The second model using Weight had a higher R² of 0.35, explaining much more of the variability.Both models reasonably satisfy the three key linear regression assumptions—linearity, nearly normal residuals, and constant variability—but the Weight model is clearly superior in terms of predictive power.



## Academic Integrity statement
I did not use AI tools to complete this assignment.
